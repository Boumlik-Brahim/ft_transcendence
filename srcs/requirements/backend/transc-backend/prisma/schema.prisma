// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//* ---------------------------------------------------------------------------------------------------------------------------- *//

model User {
  id  String @id @default(uuid())
  name  String
  email String
  password  String?
  Avatar  String?
  Status  String[]
  created_at  DateTime?
  userStat  UserStat[]
  achievement Achievement[]
  userThatBlock BlockedUser[] @relation("Bloking")
  blockedUser   BlockedUser[] @relation("blocked")
  user    Friend[]  @relation("user")
  friend  Friend[]  @relation("friend")
  senders   DirectMessage[] @relation("sendeMessage")
  receivers DirectMessage[] @relation("receiveMessage")
  channel Channel[]
  player  Game[]  @relation("player")
  openent Game[]  @relation("openent")
}

model UserStat {
  id  String  @id @default(uuid())
  winsNumbr  String
  lossesNumbr  String
  rate  Int
  user  User  @relation(fields: [userId], references: [id])
  userId  String
}

model Achievement {
  id  String @id @default(uuid())
  achievement String
  created_at  DateTime
  user  User @relation(fields: [userId], references: [id])
  userId  String
}

model BlockedUser {
  id  Int  @id @default(autoincrement())
  userThatBlock User @relation("Bloking", fields: [userId], references: [id])
  userId  String
  blockedUser User  @relation("blocked", fields: [blockedUserId], references: [id])
  blockedUserId String
}

model Friend {
  id  Int @id @default(autoincrement())
  created_at  DateTime
  friendShipStatus String[]
  user  User  @relation("user", fields: [userId], references: [id])
  userId  String
  friend  User  @relation("friend", fields: [friendId], references: [id])
  friendId  String
}

model DirectMessage {
  id  Int @id @default(autoincrement())
  content String
  created_at  DateTime
  sender  User  @relation("sendeMessage", fields: [senderId], references: [id])
  senderId String
  reciever  User  @relation("receiveMessage", fields: [recieverId], references: [id])
  recieverId  String
}

//* ---------------------------------------------------------------------------------------------------------------------------- *//

model Channel {
  id  Int @id @default(autoincrement())
  channelName String
  channelType String
  channelPassword String
  created_at  DateTime
  channelOwnerId  String
  user  User[]
  channelMember ChannelMember[] @relation("channelMember")
  kickedMember  KickedMember[]  @relation("kickedMember")
  recievers  ChannelMessage[]  @relation("receiverRelation")
}

model ChannelMember {
  id  Int @id @default(autoincrement())
  isAdmin Boolean @default(false)
  userId  String
  channel Channel @relation("channelMember", fields: [channelId], references: [id])
  channelId Int
  sender  ChannelMessage[]  @relation("senderRelation")
  isBanned Boolean @default(false)
  bannedTime DateTime
  isMuted Boolean @default(false)
  mutedTime DateTime
}

model KickedMember {
  id  Int @id @default(autoincrement())
  userId  String
  channel Channel @relation("kickedMember", fields: [channelId], references: [id])
  channelId Int
}

model ChannelMessage {
  id  Int @id @default(autoincrement())
  content String
  created_at  DateTime
  sender  ChannelMember @relation("senderRelation", fields: [memberId], references: [id])
  memberId  Int
  recievers  Channel @relation("receiverRelation", fields: [channelId], references: [id])
  channelId Int
}

//* ---------------------------------------------------------------------------------------------------------------------------- *//

model Game {
  id  String @id @default(uuid())
  gameType  String
  gameStatus String
  created_at  DateTime
  player  User  @relation("player", fields: [creatorId], references: [id])
  creatorId String
  openent User?  @relation("openent", fields: [invitedId], references: [id])
  invitedId String?
}

//* ---------------------------------------------------------------------------------------------------------------------------- *//